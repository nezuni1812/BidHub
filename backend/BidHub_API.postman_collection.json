{
	"info": {
		"_postman_id": "bidhub-api-collection",
		"name": "BidHub API",
		"description": "Complete API collection for BidHub Auction Platform - Guest User Endpoints",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:3000/api/v1",
			"type": "string"
		},
		{
			"key": "access_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "refresh_token",
			"value": "",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "Health Check",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{base_url}}/health",
					"host": ["{{base_url}}"],
					"path": ["health"]
				},
				"description": "Check API server health status"
			}
		},
		{
			"name": "Categories",
			"item": [
				{
					"name": "Get All Categories",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/categories",
							"host": ["{{base_url}}"],
							"path": ["categories"]
						},
						"description": "Get flat list of all categories with parent information"
					}
				},
				{
					"name": "Get Categories Tree",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/categories/tree",
							"host": ["{{base_url}}"],
							"path": ["categories", "tree"]
						},
						"description": "Get 2-level hierarchy of categories (parent-child structure)"
					}
				},
				{
					"name": "Get Category By ID",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/categories/:id",
							"host": ["{{base_url}}"],
							"path": ["categories", ":id"],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "Category ID"
								}
							]
						},
						"description": "Get detailed information of a specific category"
					}
				}
			]
		},
		{
			"name": "Products",
			"item": [
				{
					"name": "Get Homepage Products",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/products/home",
							"host": ["{{base_url}}"],
							"path": ["products", "home"]
						},
						"description": "Get top 5 products for homepage:\n- Ending soon\n- Most bids\n- Highest price"
					}
				},
				{
					"name": "Search Products",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/products?keyword=&category_id=&sort_by=end_time_asc&page=1&page_size=20",
							"host": ["{{base_url}}"],
							"path": ["products"],
							"query": [
								{
									"key": "keyword",
									"value": "",
									"description": "Search keyword (supports Vietnamese without accents)"
								},
								{
									"key": "category_id",
									"value": "",
									"description": "Filter by category ID"
								},
								{
									"key": "sort_by",
									"value": "end_time_asc",
									"description": "Sort: end_time_asc, end_time_desc, price_asc, price_desc"
								},
								{
									"key": "page",
									"value": "1",
									"description": "Page number"
								},
								{
									"key": "page_size",
									"value": "20",
									"description": "Items per page"
								}
							]
						},
						"description": "Search and filter products with full-text search, category filter, sorting, and pagination"
					}
				},
				{
					"name": "Search Products - By Keyword",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/products?keyword=iphone&sort_by=price_asc&page=1&page_size=10",
							"host": ["{{base_url}}"],
							"path": ["products"],
							"query": [
								{
									"key": "keyword",
									"value": "iphone"
								},
								{
									"key": "sort_by",
									"value": "price_asc"
								},
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "page_size",
									"value": "10"
								}
							]
						},
						"description": "Example: Search for 'iphone' sorted by price ascending"
					}
				},
				{
					"name": "Search Products - By Category",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/products?category_id=1&sort_by=end_time_asc&page=1&page_size=20",
							"host": ["{{base_url}}"],
							"path": ["products"],
							"query": [
								{
									"key": "category_id",
									"value": "1"
								},
								{
									"key": "sort_by",
									"value": "end_time_asc"
								},
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "page_size",
									"value": "20"
								}
							]
						},
						"description": "Example: Get products in category 1, sorted by ending time"
					}
				},
				{
					"name": "Get Product Detail",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/products/:id",
							"host": ["{{base_url}}"],
							"path": ["products", ":id"],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "Product ID"
								}
							]
						},
						"description": "Get complete product details including:\n- Product info\n- All images\n- Seller info & rating\n- Highest bidder info\n- Q&A history\n- Related products\n- Description history"
					}
				},
				{
					"name": "Get Product Bid History",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/products/:id/bids?page=1&page_size=20",
							"host": ["{{base_url}}"],
							"path": ["products", ":id", "bids"],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "page_size",
									"value": "20"
								}
							],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "Product ID"
								}
							]
						},
						"description": "Get bid history for a product (bidder names are masked)"
					}
				}
			]
		},
		{
			"name": "Authentication",
			"item": [
				{
					"name": "Register",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Auto-save tokens if registration successful",
									"if (pm.response.code === 201) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.user_id) {",
									"        pm.environment.set('user_id', jsonData.data.user_id);",
									"        pm.environment.set('test_email', pm.request.body.raw ? JSON.parse(pm.request.body.raw).email : '');",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"full_name\": \"Nguyen Van A\",\n  \"email\": \"test@example.com\",\n  \"password\": \"password123\",\n  \"address\": \"123 Nguyen Hue, Ho Chi Minh City\",\n  \"date_of_birth\": \"1990-01-15\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/register",
							"host": ["{{base_url}}"],
							"path": ["auth", "register"]
						},
						"description": "Register new user account with:\n- Full name\n- Email (must be unique)\n- Password (bcrypt hashed)\n- Address (optional)\n- Date of birth (optional)\n\nOTP will be sent to email for verification"
					}
				},
				{
					"name": "Verify OTP",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Auto-save tokens after successful verification",
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.data) {",
									"        pm.collectionVariables.set('access_token', jsonData.data.access_token);",
									"        pm.collectionVariables.set('refresh_token', jsonData.data.refresh_token);",
									"        console.log('Tokens saved!');",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"test@example.com\",\n  \"otp\": \"123456\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/verify-otp",
							"host": ["{{base_url}}"],
							"path": ["auth", "verify-otp"]
						},
						"description": "Verify OTP code sent to email.\nReturns access_token and refresh_token on success."
					}
				},
				{
					"name": "Resend OTP",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"test@example.com\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/resend-otp",
							"host": ["{{base_url}}"],
							"path": ["auth", "resend-otp"]
						},
						"description": "Resend OTP code to email if expired or not received"
					}
				},
				{
					"name": "Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Auto-save tokens after successful login",
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.data) {",
									"        pm.collectionVariables.set('access_token', jsonData.data.access_token);",
									"        pm.collectionVariables.set('refresh_token', jsonData.data.refresh_token);",
									"        console.log('Login successful! Tokens saved.');",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"test@example.com\",\n  \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/login",
							"host": ["{{base_url}}"],
							"path": ["auth", "login"]
						},
						"description": "Login with email and password.\nReturns access_token and refresh_token."
					}
				},
				{
					"name": "Refresh Token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Auto-save new access token",
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.access_token) {",
									"        pm.collectionVariables.set('access_token', jsonData.data.access_token);",
									"        console.log('Access token refreshed!');",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"refresh_token\": \"{{refresh_token}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/refresh",
							"host": ["{{base_url}}"],
							"path": ["auth", "refresh"]
						},
						"description": "Refresh access token using refresh token.\nReturns new access_token (refresh_token remains the same)."
					}
				},
				{
					"name": "Get Current User (Me)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{base_url}}/auth/me",
							"host": ["{{base_url}}"],
							"path": ["auth", "me"]
						},
						"description": "Get current authenticated user information.\nRequires access_token in Authorization header."
					}
				},
				{
					"name": "Logout",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"refresh_token\": \"{{refresh_token}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/logout",
							"host": ["{{base_url}}"],
							"path": ["auth", "logout"]
						},
						"description": "Logout from current device by revoking refresh token.\nAccess token will remain valid until expiration (15 minutes)."
					}
				},
				{
					"name": "Logout All Devices",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{base_url}}/auth/logout-all",
							"host": ["{{base_url}}"],
							"path": ["auth", "logout-all"]
						},
						"description": "Logout from all devices by revoking all refresh tokens.\nRequires access_token in Authorization header."
					}
				}
			]
		},
		{
			"name": "Test Data Examples",
			"item": [
				{
					"name": "Search Vietnamese - Dien thoai",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/products?keyword=dien thoai&page=1&page_size=10",
							"host": ["{{base_url}}"],
							"path": ["products"],
							"query": [
								{
									"key": "keyword",
									"value": "dien thoai",
									"description": "Search without accents"
								},
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "page_size",
									"value": "10"
								}
							]
						},
						"description": "Test Vietnamese search without accents"
					}
				},
				{
					"name": "Get Products Ending Soon",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/products?sort_by=end_time_asc&page=1&page_size=10",
							"host": ["{{base_url}}"],
							"path": ["products"],
							"query": [
								{
									"key": "sort_by",
									"value": "end_time_asc"
								},
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "page_size",
									"value": "10"
								}
							]
						},
						"description": "Get products ending soonest"
					}
				},
				{
					"name": "Get Highest Price Products",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/products?sort_by=price_desc&page=1&page_size=10",
							"host": ["{{base_url}}"],
							"path": ["products"],
							"query": [
								{
									"key": "sort_by",
									"value": "price_desc"
								},
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "page_size",
									"value": "10"
								}
							]
						},
						"description": "Get products with highest prices"
					}
				}
			]
		}
	]
}
